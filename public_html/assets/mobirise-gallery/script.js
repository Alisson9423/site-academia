!function(e){"use strict";function a(e){if("false"===e)return!1;var a=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e);return a?a[1]:!1}function i(a){e(a.target).closest(".mbr-slider").hasClass("in")&&a.target.playVideo()}function t(a){var i=e(a.target);"undefined"!=typeof e.fn.masonry&&i.outerFind(".mbr-gallery").each(function(){var a=e(this).find(".mbr-gallery-row").masonry({itemSelector:".mbr-gallery-item:not(.mbr-gallery-item__hided)",percentPosition:!0,horizontalOrder:!0});a.masonry("reloadItems"),a.on("filter",function(){a.masonry("reloadItems"),a.masonry("layout"),e(window).trigger("update.parallax")}.bind(this,a)),a.imagesLoaded().progress(function(){a.masonry("layout")})})}function r(){clearTimeout(m),m=setTimeout(n,50)}function n(){var a=e(".mbr-gallery .modal");if(a.length){var i=0,t=10,r=e(window).width()-2*i,n=e(window).height()-2*i;a.each(function(){var a,l,o=e(this).find(".modal-dialog"),d=o.find(".carousel-item.active > img");o.find(".carousel-item.prev > img, .carousel-item.next > img").length&&(d=o.find(".carousel-item.prev > img, .carousel-item.next > img").eq(0));var s=d[0].naturalWidth,m=d[0].naturalHeight;if(r/n>s/m){var u=n-2*t;a=u*s/m}else a=r-2*t;a=a>=s?s:a,l=(n-a*m/s)/2,o.css({width:parseInt(a),top:l+i})})}}var l=e("html").hasClass("is-builder");if(!l){var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(o,d);var s=[];window.onYouTubeIframeAPIReady=function(){var t=t||{};t.YTAPIReady||(t.YTAPIReady=!0,jQuery(document).trigger("YTAPIReady")),e(".video-slide").each(function(t){if(e(".video-container").eq(t).append('<div id ="mbr-video-'+t+'" class="mbr-background-video" data-video-num="'+t+'"></div>').append('<div class="item-overlay"></div>'),e(this).attr("data-video-num",t),-1!==e(this).attr("data-video-url").indexOf("vimeo.com")){var r={id:e(this).attr("data-video-url"),width:"100%",height:"100%",loop:!0},n=new Vimeo.Player("mbr-video-"+t,r);n.playVideo=Vimeo.play}else var n=new YT.Player("mbr-video-"+t,{height:"100%",width:"100%",videoId:a(e(this).attr("data-video-url")),events:{onReady:i},playerVars:{rel:0}});s.push(n)})}}e(document).on("add.cards",function(a){var i=e(a.target);i.find(".mbr-gallery-filter-all");i.on("click",".mbr-gallery-filter li > .button",function(a){a.preventDefault();var t=e(this).closest("li");t.parent().find("li").removeClass("active"),t.addClass("active");var r=t.closest("section").find(".mbr-gallery-row"),n=e(this).html().trim();i.find(".mbr-gallery-item").each(function(a,i){var r=e(this),l=r.attr("data-tags"),o=l.split(","),d=o.map(function(e){return e.trim()});-1!==e.inArray(n,d)||t.hasClass("mbr-gallery-filter-all")?r.removeClass("mbr-gallery-item__hided"):(r.addClass("mbr-gallery-item__hided"),setTimeout(function(){r.css("left","300px")},200))}),setTimeout(function(){r.closest(".mbr-gallery-row").trigger("filter")},50)})}),e(document).on("add.cards changeParameter.cards",function(a){var i=e(a.target),r=i.find(".mbr-gallery-filter-all"),n=[];if(i.find(".mbr-gallery-item").each(function(a){var i=(e(this).attr("data-tags")||"").trim(),t=i.split(",");t.map(function(a){var i=a.trim();-1===e.inArray(i,n)&&n.push(i)})}),i.find(".mbr-gallery-filter").length>0&&e(a.target).find(".mbr-gallery-filter").hasClass("gallery-filter-active")){var l="";i.find(".mbr-gallery-filter ul li:not(li:eq(0))").remove(),n.map(function(e){l+='<li><a class="button btn-primary-outline" href>'+e+"</a></li>"}),i.find(".mbr-gallery-filter ul").append(r).append(l)}else i.find(".mbr-gallery-item__hided").removeClass("mbr-gallery-item__hided"),i.find(".mbr-gallery-row").trigger("filter");t(a)}),e(document).on("change.cards",function(e){t(e)}),e(".mbr-gallery-item").on("click","a",function(e){e.stopPropagation()});var m,u=e(document).find(".mbr-gallery");u.on("show.bs.modal",function(a){clearTimeout(i);var i=setTimeout(function(){var i=e(a.relatedTarget).parent().index(),t=e(a.target).find(".carousel-item").eq(i).find(".mbr-background-video");if(e(a.target).find(".carousel-item .mbr-background-video"),t.length>0){var r=s[+t.attr("data-video-num")];r.playVideo?r.playVideo():r.play()}},500);r()}),u.on("slide.bs.carousel",function(a){var i=e(a.target).find(".carousel-item.active .mbr-background-video");if(i.length>0){var t=s[+i.attr("data-video-num")];t.pauseVideo?t.pauseVideo():t.pause()}}),e(window).on("resize load",r),u.on("slid.bs.carousel",function(a){var i=e(a.target).find(".carousel-item.active .mbr-background-video");if(i.length>0){var t=s[+i.attr("data-video-num")];t.playVideo?t.playVideo():t.play()}r()}),u.on("hide.bs.modal",function(e){s.map(function(e,a){e.pauseVideo?e.pauseVideo():e.pause()})})}(jQuery);